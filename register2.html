<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tech Fest 2024 - Registration</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #4a6fa5;
            --secondary: #166088;
            --accent: #ff6b6b;
            --light: #f8f9fa;
            --dark: #343a40;
            --success: #28a745;
            --warning: #ffc107;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--dark);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .logo {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 10px;
        }

        h1 {
            color: var(--secondary);
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 1.1rem;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .registration-card, .summary-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .card-title {
            color: var(--secondary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }

        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }

        input:focus, select:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(74, 111, 165, 0.2);
        }

        .event-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 10px;
        }

        .event-option {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .event-option:hover {
            border-color: var(--primary);
            background-color: rgba(74, 111, 165, 0.05);
        }

        .event-option.selected {
            border-color: var(--primary);
            background-color: rgba(74, 111, 165, 0.1);
        }

        .event-name {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--secondary);
        }

        .event-price {
            color: var(--accent);
            font-weight: bold;
        }

        .price-summary {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .price-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .total-price {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent);
            border-top: 2px solid #ddd;
            padding-top: 10px;
            margin-top: 10px;
        }

        .payment-info {
            background-color: #f0f8ff;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .qr-code {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
        }

        .qr-code img {
            max-width: 200px;
            margin: 10px auto;
            display: block;
        }

        .qr-code p {
            font-size: 0.9rem;
            color: #666;
            margin-top: 10px;
        }

        .buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--secondary);
        }

        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background-color: #5a6268;
        }

        .btn-success {
            background-color: var(--success);
            color: white;
        }

        .btn-success:hover {
            background-color: #218838;
        }

        .admit-card {
            background: linear-gradient(135deg, #4a6fa5 0%, #166088 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin-top: 30px;
            display: none;
        }

        .admit-card-header {
            margin-bottom: 20px;
        }

        .admit-card-body {
            background: white;
            color: var(--dark);
            padding: 25px;
            border-radius: 10px;
            text-align: left;
        }

        .admit-card-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px dashed #ddd;
        }

        .admit-card-label {
            font-weight: 600;
            color: var(--secondary);
        }

        .admit-card-value {
            color: var(--dark);
        }

        .admit-card-qr {
            margin: 20px auto;
            text-align: center;
        }

        .admit-card-footer {
            margin-top: 20px;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .hidden {
            display: none;
        }

        .message {
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }

        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            color: #666;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-robot"></i>
            </div>
            <h1>Tech Fest 2024 - Registration</h1>
            <p class="subtitle">Register for exciting events and get your digital admit card instantly</p>
        </header>

        <div class="main-content">
            <div class="registration-card">
                <h2 class="card-title"><i class="fas fa-user-plus"></i> Registration Form</h2>
                
                <!-- Event Selection -->
                <div class="form-group">
                    <label>Select Event(s) *</label>
                    <div class="event-options" id="eventOptions">
                        <!-- Event options will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Price Summary -->
                <div class="price-summary">
                    <div class="price-item">
                        <span>Selected Events:</span>
                        <span id="selectedEventsCount">0</span>
                    </div>
                    <div class="price-item">
                        <span>Total Amount:</span>
                        <span id="totalAmount">₹0</span>
                    </div>
                    <div class="total-price">
                        <span>Amount to Pay:</span>
                        <span id="amountToPay">₹0</span>
                    </div>
                </div>

                <!-- Personal Details -->
                <div class="form-group">
                    <label for="fullName">Full Name *</label>
                    <input type="text" id="fullName" placeholder="Enter your full name">
                </div>

                <div class="form-group">
                    <label for="collegeName">College Name *</label>
                    <input type="text" id="collegeName" placeholder="Enter your college name">
                </div>

                <div class="form-group">
                    <label for="email">Email Address *</label>
                    <input type="email" id="email" placeholder="Enter your email address">
                </div>

                <div class="form-group">
                    <label for="phone">Phone Number *</label>
                    <input type="tel" id="phone" placeholder="Enter your phone number">
                </div>

                <!-- Payment Information -->
                <div class="payment-info">
                    <h3><i class="fas fa-qrcode"></i> Payment Details</h3>
                    <p>Please scan the QR code below to make payment:</p>
                    
                    <div class="qr-code">
                        <div id="qrCodeContainer">
                            <!-- QR Code will be generated here -->
                        </div>
                        <p>Scan this QR code with any UPI app to pay</p>
                        <p><strong>UPI ID:</strong>aswinkubendiran2005-1@okicici</p>
                        <p><strong>Amount:</strong> <span id="qrAmount">₹0</span></p>
                    </div>

                    <div class="form-group">
                        <label for="transactionId">Transaction ID *</label>
                        <input type="text" id="transactionId" placeholder="Enter your transaction ID">
                        <small>Enter the UPI transaction ID after payment</small>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="buttons">
                    <button class="btn btn-secondary" id="resetBtn">
                        <i class="fas fa-redo"></i> Reset Form
                    </button>
                    <button class="btn btn-primary" id="submitBtn">
                        <i class="fas fa-paper-plane"></i> Submit Registration
                    </button>
                </div>

                <!-- Success Message -->
                <div id="successMessage" class="message success hidden">
                    <i class="fas fa-check-circle"></i> Registration successful! Check your email and download your admit card below.
                </div>
            </div>

            <div class="summary-card">
                <h2 class="card-title"><i class="fas fa-ticket-alt"></i> Admit Card</h2>
                
                <div class="admit-card" id="admitCard">
                    <div class="admit-card-header">
                        <h2><i class="fas fa-id-card"></i> Tech Fest 2024</h2>
                        <p>Official Admit Card</p>
                    </div>
                    
                    <div class="admit-card-body">
                        <div class="admit-card-row">
                            <span class="admit-card-label">Registration ID:</span>
                            <span class="admit-card-value" id="admitRegId">TECH2024001</span>
                        </div>
                        <div class="admit-card-row">
                            <span class="admit-card-label">Name:</span>
                            <span class="admit-card-value" id="admitName">-</span>
                        </div>
                        <div class="admit-card-row">
                            <span class="admit-card-label">College:</span>
                            <span class="admit-card-value" id="admitCollege">-</span>
                        </div>
                        <div class="admit-card-row">
                            <span class="admit-card-label">Event(s):</span>
                            <span class="admit-card-value" id="admitEvents">-</span>
                        </div>
                        <div class="admit-card-row">
                            <span class="admit-card-label">Transaction ID:</span>
                            <span class="admit-card-value" id="admitTransactionId">-</span>
                        </div>
                        <div class="admit-card-row">
                            <span class="admit-card-label">Date:</span>
                            <span class="admit-card-value" id="admitDate">-</span>
                        </div>
                        
                        <div class="admit-card-qr">
                            <div id="admitQrCode"></div>
                            <p>Scan this QR code at the event entrance</p>
                        </div>
                    </div>
                    
                    <div class="admit-card-footer">
                        <p>Please bring a printed copy or digital version of this admit card to the event</p>
                        <p>Venue: Central University Campus | Date: 15-17 November 2024</p>
                    </div>
                </div>

                <div id="noAdmitMessage">
                    <p style="text-align: center; color: #666; padding: 40px 20px;">
                        <i class="fas fa-ticket-alt" style="font-size: 3rem; margin-bottom: 20px; display: block; color: #ccc;"></i>
                        Your admit card will appear here after successful registration
                    </p>
                </div>

                <!-- Download Button -->
                <div class="buttons" style="margin-top: 20px;">
                    <button class="btn btn-success" id="downloadBtn" style="display: none;">
                        <i class="fas fa-download"></i> Download Admit Card
                    </button>
                    <button class="btn btn-secondary" id="printBtn" style="display: none;">
                        <i class="fas fa-print"></i> Print Admit Card
                    </button>
                </div>
            </div>
        </div>

        <footer>
            <p>© 2024 Tech Fest Organizing Committee | For queries contact: info@techfest2024.edu | Phone: +91 9876543210</p>
        </footer>
    </div>

    <!-- Include QR Code Library -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    
    <script>
        // Event data with prices
        const events = [
            { id: 1, name: "Composite Workshop", price: 1, description: "Learn composite materials" },
            { id: 2, name: "Flight Racing", price: 300, description: "RC aircraft racing competition" },
            { id: 3, name: "Drone Racing", price: 400, description: "FPV drone racing challenge" },
            { id: 4, name: "Jet Workshop", price: 600, description: "Jet engine principles workshop" },
            { id: 5, name: "Paper Presentation", price: 200, description: "Research paper presentation" }
        ];

        // Selected events and total price
        let selectedEvents = [];
        let totalAmount = 0;

        // DOM Elements
        const eventOptionsContainer = document.getElementById('eventOptions');
        const selectedEventsCount = document.getElementById('selectedEventsCount');
        const totalAmountElement = document.getElementById('totalAmount');
        const amountToPayElement = document.getElementById('amountToPay');
        const qrAmountElement = document.getElementById('qrAmount');
        const fullNameInput = document.getElementById('fullName');
        const collegeNameInput = document.getElementById('collegeName');
        const emailInput = document.getElementById('email');
        const phoneInput = document.getElementById('phone');
        const transactionIdInput = document.getElementById('transactionId');
        const submitBtn = document.getElementById('submitBtn');
        const resetBtn = document.getElementById('resetBtn');
        const successMessage = document.getElementById('successMessage');
        const admitCard = document.getElementById('admitCard');
        const noAdmitMessage = document.getElementById('noAdmitMessage');
        const downloadBtn = document.getElementById('downloadBtn');
        const printBtn = document.getElementById('printBtn');
        const qrCodeContainer = document.getElementById('qrCodeContainer');

        // Admit card elements
        const admitRegIdElement = document.getElementById('admitRegId');
        const admitNameElement = document.getElementById('admitName');
        const admitCollegeElement = document.getElementById('admitCollege');
        const admitEventsElement = document.getElementById('admitEvents');
        const admitTransactionIdElement = document.getElementById('admitTransactionId');
        const admitDateElement = document.getElementById('admitDate');
        const admitQrCodeElement = document.getElementById('admitQrCode');

        // Initialize the form
        function initForm() {
            // Create event options
            events.forEach(event => {
                const eventOption = document.createElement('div');
                eventOption.className = 'event-option';
                eventOption.dataset.id = event.id;
                eventOption.dataset.price = event.price;
                
                eventOption.innerHTML = `
                    <div class="event-name">${event.name}</div>
                    <div class="event-price">₹${event.price}</div>
                    <div class="event-description">${event.description}</div>
                `;
                
                eventOption.addEventListener('click', () => toggleEventSelection(event.id));
                eventOptionsContainer.appendChild(eventOption);
            });

            // Generate initial QR code for ₹0
            generateQRCode("techfest2024@oksbi", 0, qrCodeContainer);
            
            // Set up event listeners
            setupEventListeners();
            
            // Update price display
            updatePriceDisplay();
        }

        // Toggle event selection
        function toggleEventSelection(eventId) {
            const eventOption = document.querySelector(`.event-option[data-id="${eventId}"]`);
            const event = events.find(e => e.id === eventId);
            
            if (selectedEvents.includes(eventId)) {
                // Remove event
                selectedEvents = selectedEvents.filter(id => id !== eventId);
                eventOption.classList.remove('selected');
                totalAmount -= event.price;
            } else {
                // Add event
                selectedEvents.push(eventId);
                eventOption.classList.add('selected');
                totalAmount += event.price;
            }
            
            updatePriceDisplay();
        }

        // Update price display
        function updatePriceDisplay() {
            selectedEventsCount.textContent = selectedEvents.length;
            totalAmountElement.textContent = `₹${totalAmount}`;
            amountToPayElement.textContent = `₹${totalAmount}`;
            qrAmountElement.textContent = `₹${totalAmount}`;
            
            // Update QR code with new amount
            if (totalAmount > 0) {
                generateQRCode("techfest2024@oksbi", totalAmount, qrCodeContainer);
            }
        }

        // Generate QR code for UPI payment
        function generateQRCode(upiId, amount, container) {
            // Format: upi://pay?pa=UPI_ID&pn=Recipient&am=AMOUNT&cu=INR
            const upiString = `upi://pay?pa=${upiId}&pn=TechFest2024&am=${amount}&cu=INR`;
            
            // Clear previous QR code
            container.innerHTML = '';
            
            // Generate new QR code
            QRCode.toCanvas(upiString, { width: 200, height: 200 }, function(err, canvas) {
                if (err) {
                    console.error(err);
                    container.innerHTML = '<p>QR Code generation failed</p>';
                    return;
                }
                container.appendChild(canvas);
            });
        }

        // Generate QR code for admit card
        function generateAdmitQRCode(regId, container) {
            container.innerHTML = '';
            
            QRCode.toCanvas(regId, { width: 150, height: 150 }, function(err, canvas) {
                if (err) {
                    console.error(err);
                    container.innerHTML = '<p>QR Code generation failed</p>';
                    return;
                }
                container.appendChild(canvas);
            });
        }

        // Validate form
        function validateForm() {
            if (selectedEvents.length === 0) {
                alert("Please select at least one event");
                return false;
            }
            
            if (!fullNameInput.value.trim()) {
                alert("Please enter your full name");
                fullNameInput.focus();
                return false;
            }
            
            if (!collegeNameInput.value.trim()) {
                alert("Please enter your college name");
                collegeNameInput.focus();
                return false;
            }
            
            if (!emailInput.value.trim() || !isValidEmail(emailInput.value)) {
                alert("Please enter a valid email address");
                emailInput.focus();
                return false;
            }
            
            if (!phoneInput.value.trim() || !isValidPhone(phoneInput.value)) {
                alert("Please enter a valid 10-digit phone number");
                phoneInput.focus();
                return false;
            }
            
            if (!transactionIdInput.value.trim()) {
                alert("Please enter your transaction ID");
                transactionIdInput.focus();
                return false;
            }
            
            return true;
        }

        // Email validation
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        // Phone validation
        function isValidPhone(phone) {
            const phoneRegex = /^\d{10}$/;
            return phoneRegex.test(phone.replace(/\D/g, ''));
        }

        // Generate registration ID
        function generateRegistrationId() {
            const timestamp = Date.now().toString().slice(-6);
            const randomNum = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
            return `TECH${timestamp}${randomNum}`;
        }

        // Submit form
        function submitForm() {
            if (!validateForm()) return;
            
            // Generate registration data
            const registrationData = {
                registrationId: generateRegistrationId(),
                name: fullNameInput.value.trim(),
                college: collegeNameInput.value.trim(),
                email: emailInput.value.trim(),
                phone: phoneInput.value.trim(),
                events: selectedEvents.map(id => events.find(e => e.id === id).name),
                transactionId: transactionIdInput.value.trim(),
                amount: totalAmount,
                date: new Date().toLocaleDateString('en-IN', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                }),
                timestamp: new Date().toISOString()
            };
            
            // Show success message
            successMessage.classList.remove('hidden');
            
            // Generate and show admit card
            generateAdmitCard(registrationData);
            
            // Simulate sending email (in real implementation, this would be a server call)
            simulateEmailSend(registrationData);
            
            // Simulate adding to spreadsheet (in real implementation, this would be a server call)
            simulateSpreadsheetUpdate(registrationData);
            
            // Show download and print buttons
            downloadBtn.style.display = 'flex';
            printBtn.style.display = 'flex';
            
            // Scroll to admit card
            admitCard.scrollIntoView({ behavior: 'smooth' });
        }

        // Generate admit card
        function generateAdmitCard(data) {
            // Update admit card content
            admitRegIdElement.textContent = data.registrationId;
            admitNameElement.textContent = data.name;
            admitCollegeElement.textContent = data.college;
            admitEventsElement.textContent = data.events.join(", ");
            admitTransactionIdElement.textContent = data.transactionId;
            admitDateElement.textContent = data.date;
            
            // Generate QR code for admit card
            generateAdmitQRCode(data.registrationId, admitQrCodeElement);
            
            // Show admit card and hide placeholder
            admitCard.style.display = 'block';
            noAdmitMessage.style.display = 'none';
        }

        // Simulate email sending
        function simulateEmailSend(data) {
            console.log("Email sent to:", data.email);
            console.log("Email content:", {
                subject: "Tech Fest 2024 - Registration Confirmation",
                body: `Dear ${data.name},\n\nThank you for registering for Tech Fest 2024.\n\nRegistration ID: ${data.registrationId}\nEvents: ${data.events.join(", ")}\nAmount Paid: ₹${data.amount}\nTransaction ID: ${data.transactionId}\n\nPlease find your admit card attached.\n\nBest regards,\nTech Fest Organizing Committee`
            });
            
            // In a real implementation, you would use:
            // 1. A backend server with nodemailer (Node.js) or similar
            // 2. Or a third-party email service like SendGrid, Mailgun, etc.
            // 3. Or Google Apps Script if using Google Sheets
        }

        // Simulate spreadsheet update
        function simulateSpreadsheetUpdate(data) {
            console.log("Data added to spreadsheet:", data);
            
            // In a real implementation, you would use:
            // 1. Google Sheets API with a backend server
            // 2. Or Google Apps Script web app
            // 3. Or a database like Firebase, MongoDB, etc.
        }

        // Download admit card as image (simplified version)
        function downloadAdmitCard() {
            alert("In a real implementation, this would convert the admit card to an image/PDF and download it.");
            
            // For a real implementation, you could use:
            // 1. html2canvas library to capture the admit card as image
            // 2. jsPDF library to create a PDF
            // 3. Or generate a printable HTML page
        }

        // Print admit card
        function printAdmitCard() {
            const printContent = document.getElementById('admitCard').innerHTML;
            const originalContent = document.body.innerHTML;
            
            document.body.innerHTML = printContent;
            window.print();
            document.body.innerHTML = originalContent;
            
            // Re-initialize the page
            initForm();
            generateAdmitCard({
                registrationId: admitRegIdElement.textContent,
                name: admitNameElement.textContent,
                college: admitCollegeElement.textContent,
                events: admitEventsElement.textContent.split(", "),
                transactionId: admitTransactionIdElement.textContent,
                date: admitDateElement.textContent
            });
        }

        // Reset form
        function resetForm() {
            // Clear selected events
            selectedEvents = [];
            totalAmount = 0;
            
            // Remove selected class from event options
            document.querySelectorAll('.event-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Clear form inputs
            fullNameInput.value = '';
            collegeNameInput.value = '';
            emailInput.value = '';
            phoneInput.value = '';
            transactionIdInput.value = '';
            
            // Hide success message and admit card
            successMessage.classList.add('hidden');
            admitCard.style.display = 'none';
            noAdmitMessage.style.display = 'block';
            downloadBtn.style.display = 'none';
            printBtn.style.display = 'none';
            
            // Reset price display
            updatePriceDisplay();
            
            // Reset QR code
            generateQRCode("techfest2024@oksbi", 0, qrCodeContainer);
        }

        // Set up event listeners
        function setupEventListeners() {
            submitBtn.addEventListener('click', submitForm);
            resetBtn.addEventListener('click', resetForm);
            downloadBtn.addEventListener('click', downloadAdmitCard);
            printBtn.addEventListener('click', printAdmitCard);
            
            // Real-time validation for email
            emailInput.addEventListener('blur', function() {
                if (this.value && !isValidEmail(this.value)) {
                    this.style.borderColor = 'var(--accent)';
                } else {
                    this.style.borderColor = '#ddd';
                }
            });
            
            // Real-time validation for phone
            phoneInput.addEventListener('input', function() {
                this.value = this.value.replace(/\D/g, '').slice(0, 10);
            });
        }

        // Initialize the form when page loads
        document.addEventListener('DOMContentLoaded', initForm);
    </script>
</body>
</html>